<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DDC RVT2IFC Configuration Tool</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            background-color: #f8f9fa;
            min-height: 100vh;
            padding: 20px;
            color: #34495e;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: #ffffff;
            border-radius: 16px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.08);
            overflow: visible;
            border: 1px solid #e1e4e8;
        }

        .header {
            background: linear-gradient(45deg, #3a506b, #1c2541);
            color: #ffffff;
            padding: 30px 40px;
            text-align: left;
            border-bottom: 4px solid #fca311;
            /* New: layout for logo on the right */
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 20px;
        }

        .header-left {
            flex: 1 1 auto;
            min-width: 0;
        }

        .header-right {
            flex: 0 0 auto;
            display: flex;
            align-items: center;
            justify-content: center;
            max-width: 280px;
        }

        .header-right img {
            display: block;
            max-width: 240px;
            max-height: 120px;
            width: auto;
            height: auto;
            object-fit: contain;
            padding: 6px;
        }

        h1 {
            font-size: 2.4rem;
            font-weight: 600;
            margin-bottom: 8px;
            letter-spacing: -1px;
        }

        .subtitle {
            font-size: 1.1rem;
            font-weight: 300;
            opacity: 0.9;
        }

        .controls {
            padding: 30px 40px;
            background: #fdfdff;
            border-bottom: 1px solid #e1e4e8;
        }

        .control-section {
            margin-bottom: 25px;
        }

        .control-section h3 {
            font-size: 1.2rem;
            color: #2c3e50;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .path-inputs {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2d3748;
            font-size: 14px;
        }

        .button-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .button-group-right {
            margin-left: auto;
        }

        button {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn-primary {
            background: #fca311;
            color: #1c2541;
            font-weight: 700;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            background: #e0930f;
            box-shadow: 0 10px 20px rgba(252, 163, 17, 0.25);
        }

        .btn-secondary {
            background: #3a506b;
            color: white;
        }

        .btn-secondary:hover {
            background: #2c3e50;
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(58, 80, 107, 0.25);
        }

        .btn-danger {
            background: #d90429;
            color: white;
        }

        .btn-danger:hover {
            background: #b80322;
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(217, 4, 41, 0.3);
        }

        .btn-preset {
            background: #6c757d;
            color: white;
        }

        .btn-preset:hover {
            transform: translateY(-2px);
            background: #5a6268;
            box-shadow: 0 10px 20px rgba(108, 117, 125, 0.25);
        }

        .output {
            margin-top: 20px;
            padding: 20px;
            background: #1e1e1e;
            border-radius: 8px;
            display: none;
            position: relative;
            overflow: auto;
        }

        .output pre {
            color: #50fa7b;
            font-family: 'Fira Code', 'Consolas', 'Monaco', monospace;
            font-size: 14px;
            line-height: 1.6;
            margin: 0;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .output-header {
            color: #f8f8f2;
            font-weight: bold;
            margin-bottom: 10px;
            display: block;
        }

        .copy-button {
            position: absolute;
            top: 10px;
            right: 10px;
            padding: 8px 16px;
            font-size: 12px;
            background: #44475a;
            color: #f8f8f2;
        }

        .copy-button:hover {
            background: #6272a4;
        }

        .table-container {
            position: relative;
            padding: 20px 40px 40px;
        }

        .table-container table thead th {
            position: static;
            top: auto;
            z-index: auto;
        }

        .table-container table {
            table-layout: fixed;
            width: 100%;
        }

        .table-container table thead {
            display: none;
        }

        #stats {
            display: none;
        }

        .group-row td {
            background: #f1f5f9;
            border-top: 2px solid #e2e8f0;
            font-weight: 700;
            color: #1f2937;
            padding: 12px 15px !important;
        }

        .group-title {
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 0.6px;
        }

        table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.07);
        }

        th {
            background: #1c2541;
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
            text-transform: uppercase;
            font-size: 12px;
            letter-spacing: 0.5px;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        td {
            padding: 12px 15px;
            border-bottom: 1px solid #e1e4e8;
            background: white;
        }

        tr:last-child td {
            border-bottom: none;
        }

        tr:hover td {
            background: #f6f8fa;
        }

        .checkbox-cell {
            text-align: center;
        }

        input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
            accent-color: #fca311;
        }

        .param-name {
            font-family: 'Fira Code', 'Consolas', monospace;
            font-weight: 600;
            color: #3a506b;
            font-size: 14px;
            display: block;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .type-info {
            font-size: 12px;
            color: #64748b;
            line-height: 1.5;
        }

        .type-label {
            font-weight: 600;
            color: #475569;
        }

        .example {
            font-family: 'Fira Code', 'Consolas', monospace;
            background: #f1f5f9;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 13px;
            color: #0f172a;
            display: inline-block;
        }

        input[type="text"],
        input[type="number"],
        select,
        input[type="datetime-local"] {
            width: 100%;
            padding: 10px 12px;
            border: 2px solid #e1e4e8;
            border-radius: 6px;
            font-family: 'Fira Code', 'Consolas', monospace;
            font-size: 13px;
            transition: all 0.3s ease;
            background: #f8fafc;
        }

        input[type="text"]:focus,
        input[type="number"]:focus,
        select:focus,
        input[type="datetime-local"]:focus {
            outline: none;
            border-color: #fca311;
            background: white;
            box-shadow: 0 0 0 3px rgba(252, 163, 17, 0.15);
        }

        select {
            cursor: pointer;
        }

        .stats {
            display: flex;
            justify-content: flex-end;
            gap: 20px;
            text-align: right;
        }

        .stats span {
            margin: 0 15px;
            font-weight: 600;
        }

        .stats .count {
            color: #1c2541;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .output.show {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        .tooltip {
            position: relative;
            cursor: help;
        }

        .tooltip:hover::after {
            content: attr(data-tooltip);
            position: absolute;
            background: #1a1a1a;
            color: white;
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 12px;
            white-space: nowrap;
            bottom: 110%;
            left: 50%;
            transform: translateX(-50%);
            z-index: 100;
        }

        .bitmask-container {
            display: flex;
            flex-wrap: wrap;
            gap: 6px 12px;
            margin-top: 8px;
        }

        .bitmask-item {
            display: inline-flex;
            align-items: center;
            font-size: 12px;
            background: #f1f5f9;
            padding: 4px 6px;
            border-radius: 4px;
        }

        .bitmask-item input[type="checkbox"] {
            width: 16px;
            height: 16px;
            margin-right: 6px;
        }

        @media (max-width: 768px) {
            .path-inputs {
                grid-template-columns: 1fr;
            }

            .header {
                flex-direction: column;
                text-align: left;
                align-items: flex-start;
            }

            .header-right {
                max-width: 100%;
                align-self: flex-end;
            }
        }

        .sticky-table-header {
            position: sticky;
            top: 0;
            z-index: 15;
            display: grid;
            grid-template-columns: 50px 300px 350px 300px 1fr;
            align-items: center;
            gap: 0;
            padding: 12px 15px;
            border-bottom: 1px solid #e1e4e8;
            background: #1c2541;
            color: #fff;
            text-transform: uppercase;
            font-weight: 600;
            font-size: 12px;
            letter-spacing: 0.5px;
        }

        .sticky-table-header .col-cv {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 16px;
        }

        .sticky-table-header .hdr-stats {
            font-family: 'Fira Code', 'Consolas', monospace;
            font-weight: 700;
            color: #fca311;
        }

        .dep-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            margin-left: 8px;
            font-size: 11px;
            padding: 2px 6px;
            border-radius: 12px;
            background: #eef3ff;
            color: #3b5ccc;
            border: 1px solid #d0d8ff;
            vertical-align: middle;
        }

        .dep-badge svg {
            width: 12px;
            height: 12px;
            opacity: .85;
        }

        body.dark .dep-badge {
            background: #0f1929;
            border-color: #233557;
            color: #9db7ff;
        }

        .row-disabled {
            position: relative;
            opacity: .55;
        }

        .row-highlight {
            box-shadow: inset 0 0 0 2px rgba(252, 163, 17, .35);
        }

        tbody tr>td:last-child {
            position: relative;
        }

        .disabled-note {
            display: none;
            position: absolute;
            right: 12px;
            top: 10px;
            font-size: 11px;
            color: #6b7280;
            background: #f1f5f9;
            padding: 2px 6px;
            border-radius: 10px;
            border: 1px dashed #cbd5e1;
            white-space: nowrap;
            pointer-events: none;
        }

        body.dark .disabled-note {
            background: #0f151d;
            border-color: #2a3646;
            color: #94a3b8;
        }

        #themeBtn {
            min-width: 130px;
        }

        /* --- Dark theme --- */
        body.dark {
            --bg: #0e1116;
            --surface: #141a22;
            --surface-2: #0f141b;
            --surface-3: #0b1118;
            --header-1: #0b1326;
            --header-2: #0a0f1f;
            --border: #243244;
            --text: #e6edf3;
            --text-muted: #94a3b8;
            --text-weak: #76839a;
            --accent: #fca311;
            --accent-2: #e0930f;
            --chip: #1f2937;
        }

        body.dark {
            background: var(--bg);
            color: var(--text);
        }

        body.dark .container {
            background: var(--surface-2);
            border-color: var(--border);
            box-shadow: 0 20px 40px rgba(0, 0, 0, .35);
        }

        body.dark .header {
            background: linear-gradient(45deg, var(--header-1), var(--header-2));
            border-bottom: 4px solid var(--accent);
        }

        body.dark .subtitle {
            color: var(--text-weak);
        }

        body.dark .controls {
            background: var(--surface-3);
            border-bottom-color: var(--border);
        }

        body.dark .control-section h3 {
            color: var(--text);
        }

        body.dark .btn-primary {
            background: var(--accent);
            color: #0b0f17;
        }

        body.dark .btn-primary:hover {
            background: var(--accent-2);
            box-shadow: 0 10px 20px rgba(252, 163, 17, .25);
        }

        body.dark .btn-secondary {
            background: #22324b;
            color: #e7eef6;
        }

        body.dark .btn-secondary:hover {
            background: #1d2a41;
        }

        body.dark .btn-danger {
            background: #b31b2c;
        }

        body.dark .btn-danger:hover {
            background: #991624;
        }

        body.dark .btn-preset {
            background: #2c3642;
            color: #e5eaf0;
        }

        body.dark .btn-preset:hover {
            background: #232b35;
            box-shadow: 0 10px 20px rgba(35, 43, 53, .25);
        }

        body.dark .output {
            background: #0f1114;
        }

        body.dark .output-header {
            color: #e6edf3;
        }

        body.dark .copy-button {
            background: #2a2f3a;
            color: #dfe7ef;
        }

        body.dark .copy-button:hover {
            background: #3b4353;
        }

        body.dark .group-row td {
            background: #0f1724;
            color: #e5edf6;
            border-top: 2px solid var(--border);
        }

        body.dark table {
            box-shadow: 0 4px 6px rgba(0, 0, 0, .4);
        }

        body.dark table th {
            background: #0d1322;
            color: #dfe7ef;
        }

        body.dark table td {
            background: var(--surface);
            border-bottom: 1px solid var(--border);
        }

        body.dark tr:hover td {
            background: #101722;
        }

        body.dark input[type="text"],
        body.dark input[type="number"],
        body.dark input[type="datetime-local"],
        body.dark select {
            background: #0f141c;
            color: var(--text);
            border: 2px solid #28384d;
        }

        body.dark input[type="text"]::placeholder,
        body.dark input[type="number"]::placeholder {
            color: var(--text-weak);
        }

        body.dark input[type="text"]:focus,
        body.dark input[type="number"]:focus,
        body.dark input[type="datetime-local"]:focus,
        body.dark select:focus {
            background: #0d1219;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(252, 163, 17, .15);
        }

        body.dark .param-name {
            color: #bfd5eb;
        }

        body.dark .type-info {
            color: var(--text-muted);
        }

        body.dark .example {
            background: #0f151d;
            color: #d9e2ec;
        }

        body.dark .bitmask-item {
            background: #141b24;
            color: var(--text);
            border: 1px solid #263445;
        }

        body.dark .stats {
            background: #0f151e;
            border-top: 1px solid var(--border);
            color: var(--text-muted);
        }

        body.dark .sticky-table-header {
            background: #111827;
            border-bottom-color: rgba(255, 255, 255, 0.08);
        }

        body.dark .row-disabled::before {
            background: #0f151d;
            border-color: #2a3646;
            color: #94a3b8;
        }

        body.light .sticky-table-header {
            background: #1c2541;
        }

        .row-disabled::before {
            content: none !important;
            display: none !important;
        }
    </style>
</head>
<body>
<div class="container">
    <div class="header">
        <div class="header-left">
            <h1>DDC RVT2IFC Configuration Tool</h1>
            <p class="subtitle">Professional IFC Export Parameter Configuration</p>
        </div>
        <div class="header-right">
            <img src="data:image/png;base64,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" alt="DDC Logo">
        </div>
    </div>
    <div class="controls">
        <div class="control-section">
            <h3>File Paths</h3>
            <div class="path-inputs">
                <div class="input-group">
                    <label for="converterPath">Converter Path (RVT2IFCconverter.exe):</label>
                    <input type="text" id="converterPath" placeholder="C:/Program Files/DDC/RVT2IFCconverter.exe">
                </div>
                <div class="input-group">
                    <label for="filePath">RVT File Path:</label>
                    <input type="text" id="filePath" placeholder="C:/Users/MyUser/Documents/Project1.rvt">
                </div>
            </div>
        </div>
        <div class="control-section">
            <h3>Quick Presets</h3>
            <div class="button-group">
                <button class="btn-preset tooltip" data-tooltip="Suitable for coordination, sharing with contractors, and model checking. Includes only basic geometry and key properties." onclick="loadPreset('standard')">Standard Export</button>
                <button class="btn-preset tooltip" data-tooltip="Suitable for QTO, cost estimation, and advanced validation. Exports all properties, classifications, and coordinates." onclick="loadPreset('extended')">Extended Export</button>
                <button class="btn-preset" onclick="loadPreset('custom')">Custom (Empty)</button>
                <button class="btn-preset" onclick="loadAmericanDefaults()">Load Default Values</button>
            </div>
        </div>
        <div class="control-section">
            <h3>Actions</h3>
            <div class="button-group">
                <button class="btn-primary" onclick="generateCommand()">Generate Command</button>
                <button class="btn-secondary" onclick="selectAll()">Select All</button>
                <button class="btn-danger" onclick="clearAll()">Clear All</button>
                <div class="button-group-right">
                    <button class="btn-secondary" id="themeToggle" onclick="toggleTheme()"> ðŸŒž Light </button>
                </div>
            </div>
        </div>
        <div class="output" id="output">
            <button class="copy-button" onclick="copyToClipboard()">Copy</button>
            <pre id="outputContent"></pre>
        </div>
    </div>
    <div class="table-container">
        <div class="sticky-table-header" role="presentation">
            <div class="col-en">Enable</div>
            <div class="col-nm">Parameter</div>
            <div class="col-ty">Type &amp; Values</div>
            <div class="col-ex">Example</div>
            <div class="col-cv"> Current Value <span class="hdr-stats"> Total: <span id="hdrTotal">0</span> &nbsp;â€¢&nbsp; Selected: <span id="hdrSelected">0</span>
            </span>
            </div>
        </div>
        <table>
            <colgroup>
                <col style="width:50px">
                <col style="width:300px">
                <col style="width:350px">
                <col style="width:300px">
                <col>
            </colgroup>
            <tbody id="paramTable"></tbody>
        </table>
    </div>
</div>
<script>
    const PROPERTY_SETS_BITS = [{
        key: 'BimRvPropSets',
        bit: 1
    }, {
        key: 'IgnoreIfcPg',
        bit: 2
    }, {
        key: 'IfcCommonPropSets',
        bit: 4
    }, {
        key: 'BaseQuantities',
        bit: 8
    }, {
        key: 'Schedules',
        bit: 16
    }, {
        key: 'SchedFilter',
        bit: 32
    }, {
        key: 'MaterialPropSets',
        bit: 64
    }, {
        key: 'UserDefPSets',
        bit: 128
    }, {
        key: 'ParamMapTable',
        bit: 256
    }];
    const ADVANCED_OPTIONS_BITS = [{
        key: 'PartsAsBuildElem',
        bit: 1
    }, {
        key: 'SolidModel',
        bit: 2
    }, {
        key: 'UseActiveView',
        bit: 4
    }, {
        key: '2DRoomBound',
        bit: 8
    }, {
        key: 'IncSiteElev',
        bit: 16
    }, {
        key: 'StoreGuidAsParam',
        bit: 32
    }, {
        key: 'ExportBoundBox',
        bit: 64
    }, {
        key: 'KeepTesGeomAsTriangl',
        bit: 128
    }, {
        key: 'CoplanarFacesToExtrusion',
        bit: 256
    }, {
        key: 'DisableAnalyzers',
        bit: 512
    }, {
        key: 'SystemMaterialIsMain',
        bit: 1024
    }, {
        key: 'ExportGeometryOnly',
        bit: 2048
    }];
    // === Parameters array ===
    const parameters = [
        // ===== Core / File =====
        {
            name: "FileVersion",
            type: "enum (UInt8)",
            values: "Target IFC schema/version.",
            defaultExample: "ifc4rv",
            inputType: "select",
            options: [{
                value: "ifc2x2cv",
                text: "IFC2x2 CV"
            }, {
                value: "ifc2x2sbca",
                text: "IFC2x2 SBCA"
            }, {
                value: "ifc2x3cv",
                text: "IFC2x3 CV"
            }, {
                value: "ifc2x3",
                text: "IFC2x3 CV2 (default)"
            }, {
                value: "ifc2x3gsa",
                text: "IFC2x3 GSA Concept"
            }, {
                value: "ifc2x3bfm",
                text: "IFC2x3 Basic FM Handover"
            }, {
                value: "ifc2x3cobie",
                text: "IFC2x3 COBie 2.4"
            }, {
                value: "ifc4",
                text: "IFC4 (general)"
            }, {
                value: "ifc4rv",
                text: "IFC4 Reference View"
            }, {
                value: "ifc4dtv",
                text: "IFC4 Design Transfer View"
            }, {
                value: "ifc4x3",
                text: "IFC4x3"
            }, {
                value: "ifcsg",
                text: "IFC-SG (IFC4 based)"
            }]
        }, {
            name: "FileType",
            type: "enum (UInt8)",
            values: "Output file format.",
            defaultExample: "ifc",
            inputType: "select",
            options: [{
                value: "ifc",
                text: "IFC"
            }, {
                value: "xml",
                text: "IFC XML"
            }, {
                value: "zip",
                text: "IFC ZIP"
            }, {
                value: "hdf5",
                text: "HDF5"
            }]
        }, {
            name: "LevelOfDetail",
            type: "enum (UInt8)",
            values: "Geometry/detail level for export.",
            defaultExample: "medium",
            inputType: "select",
            options: [{
                value: "extralow",
                text: "Extra Low (0)"
            }, {
                value: "low",
                text: "Low (1)"
            }, {
                value: "medium",
                text: "Medium (2)"
            }, {
                value: "high",
                text: "High (3)"
            }]
        }, {
            name: "Phase",
            type: "UInt64",
            values: "Active Revit phase element id (0 = none).",
            defaultExample: "0",
            inputType: "number"
        }, {
            name: "SpaceBound",
            type: "enum (UInt8)",
            values: "Level of space boundary export.",
            defaultExample: "none",
            inputType: "select",
            options: [{
                value: "none",
                text: "None"
            }, {
                value: "1stlevel",
                text: "1st level"
            }, {
                value: "2ndlevel",
                text: "2nd level"
            }]
        }, {
            name: "ProjOrigin",
            type: "enum (UInt8)",
            values: "Coordinate origin to use for export.",
            defaultExample: "currentshared",
            inputType: "select",
            options: [{
                value: "currentshared",
                text: "Current/Shared"
            }, {
                value: "sitesurveypoint",
                text: "Site Survey Point"
            }, {
                value: "projectbasepoint",
                text: "Project Base Point"
            }, {
                value: "internalcoordinates",
                text: "Internal Coordinates"
            }, {
                value: "projectbasepointtruenorth",
                text: "Project Base Point True North"
            }, {
                value: "internaltruenorth",
                text: "Internal True North"
            }]
        }, {
            name: "Split",
            type: "boolean",
            values: "Split model by levels into smaller chunks if supported.",
            defaultExample: "y",
            inputType: "bool"
        }, {
            name: "Steel",
            type: "boolean",
            values: "Include/export steel-specific data.",
            defaultExample: "y",
            inputType: "bool"
        }, {
            name: "LinkedAsSeparate",
            type: "boolean",
            values: "Export linked models as separate IFC files.",
            defaultExample: "y",
            inputType: "bool"
        },
        // ===== Property Sets =====
        {
            name: "BimRvPropSets",
            type: "boolean",
            values: "Export Revit (BimRv) parameters as IFC property sets.",
            defaultExample: "y",
            inputType: "bool"
        }, {
            name: "IgnoreIfcPg",
            type: "boolean",
            values: "Ignore IFC property group (compatibility shortcut).",
            defaultExample: "y",
            inputType: "bool"
        }, {
            name: "IfcCommonPropSets",
            type: "boolean",
            values: "Export IFC common property sets.",
            defaultExample: "y",
            inputType: "bool"
        }, {
            name: "BaseQuantities",
            type: "boolean",
            values: "Export IFC base quantities (QTO).",
            defaultExample: "y",
            inputType: "bool"
        }, {
            name: "Schedules",
            type: "boolean",
            values: "Export schedules as IFC property sets.",
            defaultExample: "y",
            inputType: "bool"
        }, {
            name: "SchedFilter",
            type: "boolean",
            values: "Export only schedules with 'IFC', 'PSet' or 'Common' in the title.",
            defaultExample: "y",
            inputType: "bool"
        }, {
            name: "MaterialPropSets",
            type: "boolean",
            values: "Export material property sets.",
            defaultExample: "y",
            inputType: "bool"
        }, {
            name: "UserDefPSets",
            type: "boolean",
            values: "Enable user-defined property sets (from mapping file).",
            defaultExample: "y",
            inputType: "bool"
        }, {
            name: "UDefPSetsFileName",
            type: "string (.txt)",
            values: "Path to TXT file containing user-defined property set mapping.",
            defaultExample: "C:/data/psets/user_psets.txt",
            inputType: "text"
        }, {
            name: "ParamMapTable",
            type: "boolean",
            values: "Enable parameter-to-property mapping table.",
            defaultExample: "y",
            inputType: "bool"
        }, {
            name: "ParamMapFileName",
            type: "string (.txt)",
            values: "Path to TXT file describing parameter mapping table.",
            defaultExample: "C:/data/mapping/parammap.txt",
            inputType: "text"
        },
        // ===== Header / File Header =====
        {
            name: "FhFileDesc",
            type: "string",
            values: "IFC header: file description.",
            defaultExample: "Coordination export for Berlin Office",
            inputType: "text"
        }, {
            name: "FhFileName",
            type: "string",
            values: "IFC header: source file name in header (informational).",
            defaultExample: "BerlinOffice_Export.ifc",
            inputType: "text"
        }, {
            name: "FhAuthName",
            type: "string",
            values: "IFC header: author name.",
            defaultExample: "DataDrivenConstruction",
            inputType: "text"
        }, {
            name: "FhAuthEmail",
            type: "string",
            values: "IFC header: author e-mail.",
            defaultExample: "info@datadrivenconstruction.io",
            inputType: "text"
        }, {
            name: "FhOrganiz",
            type: "string",
            values: "IFC header: author organization.",
            defaultExample: "DataDrivenConstruction",
            inputType: "text"
        }, {
            name: "FhAuthoriz",
            type: "string",
            values: "IFC header: authorization/issuer organization.",
            defaultExample: "DataDrivenConstruction",
            inputType: "text"
        }, {
            name: "FhAppName",
            type: "string",
            values: "IFC header: application name.",
            defaultExample: "RVT2IFCconverter",
            inputType: "text"
        }, {
            name: "FhVersion",
            type: "string",
            values: "IFC header: application version.",
            defaultExample: "1.0.0",
            inputType: "text"
        }, {
            name: "FhFSchema",
            type: "string",
            values: "IFC header: schema label.",
            defaultExample: "IFC4",
            inputType: "text"
        }, {
            name: "FhExchange",
            type: "enum (UInt8)",
            values: "IFC header: 'exchange requirement' / domain.",
            defaultExample: "none",
            inputType: "select",
            options: [{
                value: "none",
                text: "None"
            }, {
                value: "architectural",
                text: "Architectural Reference Exchange"
            }, {
                value: "mep",
                text: "MEP Reference Exchange"
            }, {
                value: "structural",
                text: "Structural Reference Exchange"
            }]
        },
        // ===== Project Address =====
        {
            name: "PaPurpose",
            type: "enum (UInt8)",
            values: "Address purpose classification.",
            defaultExample: "office",
            inputType: "select",
            options: [{
                value: "none",
                text: "None"
            }, {
                value: "office",
                text: "Office"
            }, {
                value: "site",
                text: "Site"
            }, {
                value: "home",
                text: "Home"
            }, {
                value: "distributionpoint",
                text: "Distribution Point"
            }, {
                value: "userdefined",
                text: "User Defined"
            }]
        }, {
            name: "PaProjDesc",
            type: "string",
            values: "Project description.",
            defaultExample: "Office campus near Tiergarten, Berlin",
            inputType: "text"
        }, {
            name: "PaUserDefPurpose",
            type: "string",
            values: "Custom purpose when 'userdefined' is selected.",
            defaultExample: "",
            inputType: "text"
        }, {
            name: "PaAddrLine1",
            type: "string",
            values: "Address line 1.",
            defaultExample: "Alexanderplatz 1",
            inputType: "text"
        }, {
            name: "PaAddrLine2",
            type: "string",
            values: "Address line 2.",
            defaultExample: "Mitte",
            inputType: "text"
        }, {
            name: "PaPOBox",
            type: "string",
            values: "P.O. Box (if applicable).",
            defaultExample: "",
            inputType: "text"
        }, {
            name: "PaCity",
            type: "string",
            values: "City.",
            defaultExample: "Berlin",
            inputType: "text"
        }, {
            name: "PaPostCode",
            type: "string",
            values: "Postal/ZIP code.",
            defaultExample: "10178",
            inputType: "text"
        }, {
            name: "PaState",
            type: "string",
            values: "State/Region (optional).",
            defaultExample: "Berlin",
            inputType: "text"
        }, {
            name: "PaCountry",
            type: "string",
            values: "Country (ISO code or label).",
            defaultExample: "DE",
            inputType: "text"
        }, {
            name: "PaIntLoc",
            type: "string",
            values: "Internal location information.",
            defaultExample: "Building A, Level 2",
            inputType: "text"
        }, {
            name: "PaOverrideAddress",
            type: "boolean",
            values: "Override address from the model with values provided here.",
            defaultExample: "y",
            inputType: "bool"
        }, {
            name: "PaAddrToBuild",
            type: "boolean",
            values: "Assign address to Building entity.",
            defaultExample: "y",
            inputType: "bool"
        }, {
            name: "PaAddrToSite",
            type: "boolean",
            values: "Assign address to Site entity.",
            defaultExample: "y",
            inputType: "bool"
        },
        // ===== Visibility / Selection =====
        {
            name: "2DPlanViewEl",
            type: "boolean",
            values: "Include 2D plan symbols/elements.",
            defaultExample: "y",
            inputType: "bool"
        }, {
            name: "VisibleOnly",
            type: "boolean",
            values: "Export only elements that are visible in the chosen view.",
            defaultExample: "y",
            inputType: "bool"
        }, {
            name: "FilterViewName",
            type: "string",
            values: "View name to match (case-insensitive; substring allowed).",
            defaultExample: "Coordination",
            inputType: "text"
        }, {
            name: "FilterViewId",
            type: "string or UInt64",
            values: "View id (numeric) or 'auto' for the default 3D view.",
            defaultExample: "auto",
            inputType: "text"
        }, {
            name: "RoomsIn3D",
            type: "boolean",
            values: "Export rooms/spaces as 3D volumes when 'VisibleOnly' is used.",
            defaultExample: "y",
            inputType: "bool"
        },
        // ===== CLOD (tessellation) =====
        {
            name: "CLOD_MaxNumGridLines",
            type: "UInt32",
            values: "Maximum number of grid lines to export.",
            defaultExample: "10000",
            inputType: "number"
        }, {
            name: "CLOD_MaxFacetEdgeLength",
            type: "double",
            values: "Maximum length per tessellated edge.",
            defaultExample: "100000",
            inputType: "text"
        }, {
            name: "CLOD_NormalTolerance",
            type: "double",
            values: "Angular tolerance for normals (degrees).",
            defaultExample: "360",
            inputType: "text"
        }, {
            name: "CLOD_SurfaceTolerance",
            type: "double",
            values: "Surface deviation tolerance.",
            defaultExample: "0",
            inputType: "text"
        }, {
            name: "CLOD_GridAspectRatio",
            type: "double",
            values: "Aspect ratio for tessellation grid.",
            defaultExample: "0",
            inputType: "text"
        }, {
            name: "CLOD_BetweenKnots",
            type: "UInt16",
            values: "Number of between-knot points for splines/NURBS.",
            defaultExample: "0",
            inputType: "number"
        }, {
            name: "CLOD_PointsPerEdge",
            type: "UInt32",
            values: "Number of tessellation points per edge.",
            defaultExample: "0",
            inputType: "number"
        }, {
            name: "CLOD_RecalculateSurfaceTolerance",
            type: "boolean",
            values: "Recalculate surface tolerance to improve accuracy.",
            defaultExample: "y",
            inputType: "bool"
        }, {
            name: "CLOD_FastMode",
            type: "boolean",
            values: "Favor speed over precision.",
            defaultExample: "y",
            inputType: "bool"
        }, {
            name: "CLOD_UseTesselation",
            type: "boolean",
            values: "Use tessellated (triangulated) geometry.",
            defaultExample: "y",
            inputType: "bool"
        }, {
            name: "CLOD_Curve3dPointsEpsilon",
            type: "double",
            values: "Tolerance/epsilon for curve discretization.",
            defaultExample: "0.0",
            inputType: "text"
        },
        // ===== Advanced Options =====
        {
            name: "PartsAsBuildElem",
            type: "boolean",
            values: "Export Parts as Building Elements.",
            defaultExample: "y",
            inputType: "bool"
        }, {
            name: "SolidModel",
            type: "boolean",
            values: "Prefer solid/BRep export where possible.",
            defaultExample: "y",
            inputType: "bool"
        }, {
            name: "UseActiveView",
            type: "boolean",
            values: "Apply active view filters/cuts from current view.",
            defaultExample: "y",
            inputType: "bool"
        }, {
            name: "2DRoomBound",
            type: "boolean",
            values: "Use 2D room boundaries when exporting rooms/spaces.",
            defaultExample: "y",
            inputType: "bool"
        }, {
            name: "IncSiteElev",
            type: "boolean",
            values: "Include site elevation offset.",
            defaultExample: "y",
            inputType: "bool"
        }, {
            name: "StoreGuidAsParam",
            type: "boolean",
            values: "Write generated IFC GUID into a Revit parameter.",
            defaultExample: "y",
            inputType: "bool"
        }, {
            name: "ExportBoundBox",
            type: "boolean",
            values: "Export bounding box representations.",
            defaultExample: "y",
            inputType: "bool"
        }, {
            name: "KeepTesGeomAsTriangl",
            type: "boolean",
            values: "Keep tessellated geometry as triangulation.",
            defaultExample: "y",
            inputType: "bool"
        }, {
            name: "CoplanarFacesToExtrusion",
            type: "boolean",
            values: "Try converting coplanar faces to extrusions.",
            defaultExample: "y",
            inputType: "bool"
        }, {
            name: "DisableAnalyzers",
            type: "boolean",
            values: "Disable extrusion and swept solid analyzers.",
            defaultExample: "y",
            inputType: "bool"
        }, {
            name: "SystemMaterialIsMain",
            type: "boolean",
            values: "Use system material as the main material.",
            defaultExample: "y",
            inputType: "bool"
        }, {
            name: "ExportGeometryOnly",
            type: "boolean",
            values: "Export only geometry (omit all metadata).",
            defaultExample: "y",
            inputType: "bool"
        },
        // ===== Naming behavior =====
        {
            name: "UseFamTypeRef",
            type: "boolean",
            values: "Use family/type reference in IFC names.",
            defaultExample: "y",
            inputType: "bool"
        }, {
            name: "UseVisibleNameAsEntityName",
            type: "boolean",
            values: "Use visible element name as IFC entity name.",
            defaultExample: "y",
            inputType: "bool"
        }, {
            name: "UseTypeNameOnlyForIfcType",
            type: "boolean",
            values: "For IFC type names, use only the type name.",
            defaultExample: "y",
            inputType: "bool"
        },
        // ===== Elements selection lists =====
        {
            name: "ElementsToExport",
            type: "list of UInt64",
            values: "List of element ids to include (semicolon separated).",
            defaultExample: "12345; 67890",
            inputType: "text"
        }, {
            name: "ElementsToExclude",
            type: "list of UInt64",
            values: "List of element ids to exclude (semicolon separated).",
            defaultExample: "",
            inputType: "text"
        }, {
            name: "ExcludeList",
            type: "list of string",
            values: "IFC entity types to exclude (semicolon separated).",
            defaultExample: "IfcSpace; IfcOpeningElement",
            inputType: "text"
        },
        // ===== Classification =====
        {
            name: "ClName",
            type: "string",
            values: "Classification name/title.",
            defaultExample: "DIN 276",
            inputType: "text"
        }, {
            name: "ClSource",
            type: "string",
            values: "Classification source/publisher.",
            defaultExample: "DIN",
            inputType: "text"
        }, {
            name: "ClEdition",
            type: "string",
            values: "Classification edition/version.",
            defaultExample: "2018",
            inputType: "text"
        }, {
            name: "ClEditTime",
            type: "Int64",
            values: "Edition date as Unix timestamp (seconds).",
            defaultExample: "1546300800",
            inputType: "datetime"
        }, {
            name: "ClDocLocation",
            type: "string",
            values: "Document/URL for classification.",
            defaultExample: "https://din.de/276",
            inputType: "text"
        }, {
            name: "ClFieldName",
            type: "string",
            values: "Revit parameter where classification code is stored.",
            defaultExample: "ClassificationCode",
            inputType: "text"
        },
        // ===== Geo =====
        {
            name: "GeoRefCRSName",
            type: "string",
            values: "Coordinate Reference System name.",
            defaultExample: "ETRS89 / UTM zone 33N",
            inputType: "text"
        }, {
            name: "GeoRefCRSDesc",
            type: "string",
            values: "CRS short description.",
            defaultExample: "European Terrestrial Reference System 1989",
            inputType: "text"
        }, {
            name: "GeoRefEPSGCode",
            type: "string",
            values: "EPSG code for CRS.",
            defaultExample: "25833",
            inputType: "text"
        }, {
            name: "GeoRefGeodeticDatum",
            type: "string",
            values: "Geodetic datum name.",
            defaultExample: "ETRS89",
            inputType: "text"
        }, {
            name: "GeoRefMapUnit",
            type: "string",
            values: "Linear unit for coordinates (meter/foot).",
            defaultExample: "meter",
            inputType: "text"
        },
        // ===== Facility =====
        {
            name: "FacilityType",
            type: "enum (UInt8)",
            values: "Facility domain/type.",
            defaultExample: "building",
            inputType: "select",
            options: [{
                value: "notdefined",
                text: "Not defined"
            }, {
                value: "building",
                text: "Building"
            }, {
                value: "bridge",
                text: "Bridge"
            }, {
                value: "railway",
                text: "Railway"
            }, {
                value: "road",
                text: "Road"
            }, {
                value: "marinefacility",
                text: "Marine facility"
            }]
        }, {
            name: "FacilityPredefinedType",
            type: "string",
            values: "Specific sub-type (free text).",
            defaultExample: "OFFICE",
            inputType: "text"
        },
        // ===== Category mapping (.txt / template) =====
        {
            name: "CategoryMappingFile",
            type: "string (.txt)",
            values: "Path to external category mapping table (.txt).",
            defaultExample: "C:/data/mapping/categories.txt",
            inputType: "text"
        }, {
            name: "CategoryMappingTemplate",
            type: "string (template name)",
            values: "Name of a category mapping template registered in the model (not a file path).",
            defaultExample: "MyCompany_General",
            inputType: "text"
        },
        // ===== Company / Contact =====
        {
            name: "CompanyType",
            type: "string",
            values: "Company type/role.",
            defaultExample: "Consultant",
            inputType: "text"
        }, {
            name: "CompanyName",
            type: "string",
            values: "Company legal name.",
            defaultExample: "DataDrivenConstruction",
            inputType: "text"
        }, {
            name: "StreetAddr",
            type: "string",
            values: "Street and number.",
            defaultExample: "FriedrichstraÃŸe 44",
            inputType: "text"
        }, {
            name: "City",
            type: "string",
            values: "City where company is registered.",
            defaultExample: "Berlin",
            inputType: "text"
        }, {
            name: "State",
            type: "string",
            values: "State/region (if applicable).",
            defaultExample: "Berlin",
            inputType: "text"
        }, {
            name: "PostCode",
            type: "string",
            values: "Postal/ZIP code.",
            defaultExample: "10117",
            inputType: "text"
        }, {
            name: "Country",
            type: "string",
            values: "Country code or label.",
            defaultExample: "DE",
            inputType: "text"
        }, {
            name: "CompanyPhone",
            type: "string",
            values: "Main contact phone.",
            defaultExample: "+49 30 1234567",
            inputType: "text"
        }, {
            name: "CompanyEmail",
            type: "string",
            values: "Main contact e-mail.",
            defaultExample: "info@datadrivenconstruction.io",
            inputType: "text"
        },
        // ===== Building / Project / Site =====
        {
            name: "BuildName",
            type: "string",
            values: "Building name/title.",
            defaultExample: "Berlin Office Tower",
            inputType: "text"
        }, {
            name: "BuildType",
            type: "string",
            values: "Building usage/type.",
            defaultExample: "Office",
            inputType: "text"
        }, {
            name: "BuildDesc",
            type: "string",
            values: "Building description.",
            defaultExample: "High-rise with mixed-use podium",
            inputType: "text"
        }, {
            name: "ProjName",
            type: "string",
            values: "Project name/title.",
            defaultExample: "Berlin Office Campus",
            inputType: "text"
        }, {
            name: "ProjDesc",
            type: "string",
            values: "Project description for IFC header.",
            defaultExample: "Phase 2 expansion near Tiergarten",
            inputType: "text"
        }, {
            name: "ProjPhase",
            type: "string",
            values: "Project phase string.",
            defaultExample: "Design Development",
            inputType: "text"
        }, {
            name: "SiteLoc",
            type: "string",
            values: "Site location (free text).",
            defaultExample: "Mitte, Berlin",
            inputType: "text"
        }, {
            name: "SiteDesc",
            type: "string",
            values: "Site general description.",
            defaultExample: "Urban infill site near train station",
            inputType: "text"
        }
    ];
    // === Grouping ===
    const parameterGroups = [{
        title: "Core / File",
        keys: ["FileVersion", "FileType", "LevelOfDetail", "Phase", "SpaceBound", "ProjOrigin", "Split", "Steel", "LinkedAsSeparate"]
    }, {
        title: "Property Sets",
        keys: ["PropertySets", "BimRvPropSets", "IgnoreIfcPg", "IfcCommonPropSets", "BaseQuantities", "Schedules", "SchedFilter", "MaterialPropSets", "UserDefPSets", "UDefPSetsFileName", "ParamMapTable", "ParamMapFileName"]
    }, {
        title: "Header / File Header",
        keys: ["FhFileDesc", "FhFileName", "FhAuthName", "FhAuthEmail", "FhOrganiz", "FhAuthoriz", "FhAppName", "FhVersion", "FhFSchema", "FhExchange"]
    }, {
        title: "Project Address",
        keys: ["PaPurpose", "PaProjDesc", "PaUserDefPurpose", "PaAddrLine1", "PaAddrLine2", "PaPOBox", "PaCity", "PaPostCode", "PaState", "PaCountry", "PaIntLoc", "PaOverrideAddress", "PaAddrToBuild", "PaAddrToSite"]
    }, {
        title: "Visibility / Selection",
        keys: ["2DPlanViewEl", "VisibleOnly", "FilterViewName", "FilterViewId", "RoomsIn3D"]
    }, {
        title: "CLOD (Tessellation)",
        keys: ["CLOD_MaxNumGridLines", "CLOD_MaxFacetEdgeLength", "CLOD_NormalTolerance", "CLOD_SurfaceTolerance", "CLOD_GridAspectRatio", "CLOD_BetweenKnots", "CLOD_PointsPerEdge", "CLOD_RecalculateSurfaceTolerance", "CLOD_FastMode", "CLOD_UseTesselation", "CLOD_Curve3dPointsEpsilon"]
    }, {
        title: "Advanced Options",
        keys: ["AdvancedOptions", "PartsAsBuildElem", "SolidModel", "UseActiveView", "2DRoomBound", "IncSiteElev", "StoreGuidAsParam", "ExportBoundBox", "KeepTesGeomAsTriangl", "CoplanarFacesToExtrusion", "DisableAnalyzers", "SystemMaterialIsMain", "ExportGeometryOnly"]
    }, {
        title: "Naming Behavior",
        keys: ["UseFamTypeRef", "UseVisibleNameAsEntityName", "UseTypeNameOnlyForIfcType"]
    }, {
        title: "Elements Selection",
        keys: ["ElementsToExport", "ElementsToExclude", "ExcludeList"]
    }, {
        title: "Classification",
        keys: ["ClName", "ClSource", "ClEdition", "ClEditTime", "ClDocLocation", "ClFieldName"]
    }, {
        title: "Geo",
        keys: ["GeoRefCRSName", "GeoRefCRSDesc", "GeoRefEPSGCode", "GeoRefGeodeticDatum", "GeoRefMapUnit"]
    }, {
        title: "Facility",
        keys: ["FacilityType", "FacilityPredefinedType"]
    }, {
        title: "Category Mapping (.txt)",
        keys: ["CategoryMappingFile", "CategoryMappingTemplate"]
    }, {
        title: "Company / Contact",
        keys: ["CompanyType", "CompanyName", "StreetAddr", "City", "State", "PostCode", "Country", "CompanyPhone", "CompanyEmail"]
    }, {
        title: "Building / Project / Site",
        keys: ["BuildName", "BuildType", "BuildDesc", "ProjName", "ProjDesc", "ProjPhase", "SiteLoc", "SiteDesc"]
    }];
    // === Dependencies ===
    const DEPENDENCIES = {
        VisibleOnly: ['FilterViewId', 'FilterViewName', 'RoomsIn3D'],
        UserDefPSets: ['UDefPSetsFileName'],
        ParamMapTable: ['ParamMapFileName'],
        Schedules: ['SchedFilter']
    };
    // NEW: mutual exclusions (anti-dependencies)
    const MUTEX = [
        ['FilterViewId', 'FilterViewName']
    ];
    const PARENTS = {};
    Object.keys(DEPENDENCIES).forEach(parent => {
        DEPENDENCIES[parent].forEach(child => {
            PARENTS[child] = parent;
        });
    });


    const PATH_PARAMS = new Set(['UDefPSetsFileName', 'ParamMapFileName', 'CategoryMappingFile']);

    const paramByName = {};
    parameters.forEach(p => {
        paramByName[p.name] = p;
    });

    function setChildEnabled(child, enabled) {
        const cb = document.getElementById('check_' + child);
        if (cb) {
            cb.disabled = !enabled;
            if (!enabled) cb.checked = false;
        }
        const inp = document.getElementById('input_' + child) || document.getElementById('input_' + child + '_num') || document.getElementById('input_' + child + '_dt');
        if (inp) inp.disabled = !enabled;
        const row = document.getElementById('row_' + child);
        if (row) {
            row.style.opacity = enabled ? '1' : '.55';
            const note = row.querySelector('.disabled-note');
            if (note) {
                const parentName = PARENTS[child] || '';
                note.textContent = !enabled && parentName ? `Disabled: depends on "${parentName}"` : '';
                note.style.display = (!enabled && parentName) ? 'inline-flex' : 'none';
            }
        }
    }

    function applyDependencies() {
        Object.keys(DEPENDENCIES).forEach(parent => {
            const pcb = document.getElementById('check_' + parent);
            const on = !!(pcb && pcb.checked);
            (DEPENDENCIES[parent] || []).forEach(ch => setChildEnabled(ch, on));
        });
        applyMutex();
    }

    function applyMutex() {
        MUTEX.forEach(([a, b]) => {
            const cbA = document.getElementById('check_' + a);
            const cbB = document.getElementById('check_' + b);
            const inputA = document.getElementById('input_' + a);
            const inputB = document.getElementById('input_' + b);
            const rowA = document.getElementById('row_' + a);
            const rowB = document.getElementById('row_' + b);
            const noteA = rowA ? rowA.querySelector('.disabled-note') : null;
            const noteB = rowB ? rowB.querySelector('.disabled-note') : null;
            if (!cbA || !cbB) return;
            const parentAOn = !PARENTS[a] || (document.getElementById('check_' + PARENTS[a])?.checked);
            const parentBOn = !PARENTS[b] || (document.getElementById('check_' + PARENTS[b])?.checked);
            const resetRow = (row, input, note) => {
                if (row) row.classList.remove('row-disabled');
                if (input) input.disabled = false;
                if (note) {
                    note.textContent = '';
                    note.style.display = 'none';
                }
            };
            if (!parentAOn || !parentBOn) {
                resetRow(rowA, inputA, noteA);
                resetRow(rowB, inputB, noteB);
                return;
            }
            if (cbA.checked) {
                cbB.checked = false;
                if (inputB) inputB.disabled = true;
                if (rowB) rowB.classList.add('row-disabled');
                if (noteB) {
                    noteB.textContent = `Disabled: conflicts with "${a}"`;
                    noteB.style.display = 'inline-flex';
                }
            } else {
                resetRow(rowB, inputB, noteB);
            }
            if (cbB.checked) {
                cbA.checked = false;
                if (inputA) inputA.disabled = true;
                if (rowA) rowA.classList.add('row-disabled');
                if (noteA) {
                    noteA.textContent = `Disabled: conflicts with "${b}"`;
                    noteA.style.display = 'inline-flex';
                }
            } else {
                resetRow(rowA, inputA, noteA);
            }
        });
        updateStats();
    }

    function initDependencies() {
        Object.keys(DEPENDENCIES).forEach(parent => {
            const pcb = document.getElementById('check_' + parent);
            if (!pcb) return;
            pcb.addEventListener('change', applyDependencies);
        });
        // For mutex pairs, bind change listener to force exclusive selection
        MUTEX.forEach(([a, b]) => {
            const cbA = document.getElementById('check_' + a);
            const cbB = document.getElementById('check_' + b);
            if (cbA) cbA.addEventListener('change', () => {
                if (cbA.checked) {
                    cbB.checked = false;
                }
                applyDependencies();
            });
            if (cbB) cbB.addEventListener('change', () => {
                if (cbB.checked) {
                    cbA.checked = false;
                }
                applyDependencies();
            });
        });
        applyDependencies();
    }

    function stripOuterQuotes(s) {
        if (!s) return s;
        s = s.trim();
        // remove all symmetrical quotes from the ends
        while (
            (s.startsWith('"') && s.endsWith('"')) ||
            (s.startsWith("'") && s.endsWith("'"))
            ) {
            s = s.slice(1, -1).trim();
        }
        return s;
    }
    function normalizePath(p) {
        if (!p) return p;
        p = stripOuterQuotes(p);
        return p.replace(/\\/g, '/');
    }
    function asQuoted(value) {
        return `"${String(value).replace(/"/g, '\\"')}"`;
    }

    function parseMaskFromInput(text, bits) {
        if (!text) return 0;
        const t = text.trim();
        if (/^\d+$/.test(t)) {
            return parseInt(t, 10) >>> 0;
        } else {
            const toks = t.split(/[|]+/).map(s => s.trim()).filter(s => s.length > 0);
            let mask = 0;
            toks.forEach(tok => {
                const m = bits.find(b => b.key.toLowerCase() === tok.toLowerCase());
                if (m) mask |= m.bit;
            });
            return mask >>> 0;
        }
    }

    function renderBitmaskField(param, tdInput) {
        const txt = document.createElement('input');
        txt.type = 'text';
        txt.id = 'input_' + param.name;
        txt.placeholder = 'Enter mask or tokens (e.g. BimRvPropSets|IgnoreIfcPg)';
        tdInput.appendChild(txt);
        const container = document.createElement('div');
        container.className = 'bitmask-container';
        (param.bits || []).forEach(bitEntry => {
            const item = document.createElement('label');
            item.className = 'bitmask-item';
            item.title = `${bitEntry.key} (${bitEntry.bit})`;
            const cb = document.createElement('input');
            cb.type = 'checkbox';
            cb.dataset.key = bitEntry.key;
            cb.dataset.bit = String(bitEntry.bit);
            cb.addEventListener('change', () => {
                const mask = computeBitmaskFromCheckboxes(param.name);
                txt.value = String(mask);
            });
            const span = document.createElement('span');
            span.textContent = bitEntry.key;
            item.appendChild(cb);
            item.appendChild(span);
            container.appendChild(item);
        });
        tdInput.appendChild(container);
        txt.addEventListener('input', () => {
            syncCheckboxesWithText(param.name, param.bits || []);
        });
    }

    function computeBitmaskFromCheckboxes(paramName) {
        const td = document.getElementById('input_' + paramName)?.parentElement;
        if (!td) return 0;
        const cbs = td.querySelectorAll('.bitmask-container input[type="checkbox"]');
        let mask = 0;
        cbs.forEach(cb => {
            if (cb.checked) mask |= parseInt(cb.dataset.bit, 10);
        });
        return mask >>> 0;
    }

    function syncCheckboxesWithText(paramName, bits) {
        const txt = document.getElementById('input_' + paramName);
        if (!txt) return;
        const val = txt.value;
        const mask = parseMaskFromInput(val, bits);
        const td = txt.parentElement;
        const cbs = td.querySelectorAll('.bitmask-container input[type="checkbox"]');
        cbs.forEach(cb => {
            const bit = parseInt(cb.dataset.bit, 10);
            cb.checked = ((mask & bit) !== 0);
        });
    }

    function renderDatetimeField(param, tdInput) {
        const wrapper = document.createElement('div');
        const number = document.createElement('input');
        number.type = 'number';
        number.id = 'input_' + param.name + '_num';
        number.placeholder = param.defaultExample || '0';
        number.min = '0';
        number.step = '1';
        const dt = document.createElement('input');
        dt.type = 'datetime-local';
        dt.id = 'input_' + param.name + '_dt';
        dt.placeholder = 'YYYY-MM-DDTHH:MM';
        dt.addEventListener('change', () => {
            const v = dt.value;
            if (v) {
                const d = new Date(v);
                const sec = Math.floor(d.getTime() / 1000);
                number.value = String(sec);
            } else {
                number.value = '';
            }
        });
        number.addEventListener('input', () => {
            const n = parseInt(number.value, 10);
            if (!isNaN(n) && n > 0) {
                const d = new Date(n * 1000);
                const pad = x => (x < 10 ? '0' : '') + x;
                const yyyy = d.getFullYear();
                const MM = pad(d.getMonth() + 1);
                const dd = pad(d.getDate());
                const hh = pad(d.getHours());
                const mm = pad(d.getMinutes());
                dt.value = `${yyyy}-${MM}-${dd}T${hh}:${mm}`;
            } else {
                dt.value = '';
            }
        });
        wrapper.appendChild(number);
        wrapper.appendChild(document.createElement('br'));
        wrapper.appendChild(document.createElement('br'));
        wrapper.appendChild(dt);
        tdInput.appendChild(wrapper);
    }
    let TOTAL_PARAMS = 0;

    function createTable() {
        const tbody = document.getElementById('paramTable');
        tbody.innerHTML = '';
        let renderedCount = 0;
        parameterGroups.forEach(group => {
            const headerTr = document.createElement('tr');
            headerTr.className = 'group-row';
            const headerTd = document.createElement('td');
            headerTd.colSpan = 5;
            headerTd.innerHTML = `<span class="group-title">${group.title}</span>`;
            headerTr.appendChild(headerTd);
            tbody.appendChild(headerTr);
            group.keys.forEach(key => {
                const param = paramByName[key];
                if (!param) return;
                const tr = document.createElement('tr');
                tr.id = 'row_' + param.name;
                const parentOfThis = PARENTS[key];
                if (parentOfThis) tr.dataset.parent = parentOfThis;
                const tdCheck = document.createElement('td');
                tdCheck.className = 'checkbox-cell';
                const checkbox = document.createElement('input');
                checkbox.type = 'checkbox';
                checkbox.id = 'check_' + param.name;
                checkbox.onchange = () => {
                    updateStats();
                    applyDependencies();
                };
                tdCheck.appendChild(checkbox);
                tr.appendChild(tdCheck);
                const tdName = document.createElement('td');
                tdName.innerHTML = `<span class="param-name">${param.name}</span>`;
                tr.appendChild(tdName);

                const tdType = document.createElement('td');
                tdType.innerHTML = `<div class="type-info">
                                        <span class="type-label">${param.type}</span>
                                        <br>${param.values}
                                    </div>`;
                if (parentOfThis) {
                    const badge = document.createElement('span');
                    badge.className = 'dep-badge';
                    badge.title = `Depends on "${parentOfThis}"`;
                    badge.innerHTML = `
                    <svg viewBox="0 0 16 16" fill="currentColor" aria-hidden="true">
                      <path d="M4.5 2.5a.5.5 0 0 1 .5-.5h6a.5.5 0 0 1 .4.2l2 2.5a.5.5 0 0 1 .1.3v6a.5.5 0 0 1-.5.5H5a.5.5 0 0 1-.5-.5V3a.5.5 0 0 1 .5-.5Z"/>
                    </svg>
                    depends on ${parentOfThis}
                  `;
                    badge.addEventListener('mouseenter', () => {
                        const prow = document.getElementById('row_' + parentOfThis);
                        if (prow) prow.classList.add('row-highlight');
                    });
                    badge.addEventListener('mouseleave', () => {
                        const prow = document.getElementById('row_' + parentOfThis);
                        if (prow) prow.classList.remove('row-highlight');
                    });
                    tdName.appendChild(badge);
                }
                tr.appendChild(tdType);
                const tdExample = document.createElement('td');
                tdExample.innerHTML = `<span class="example">${param.defaultExample}</span>`;
                tr.appendChild(tdExample);
                const tdInput = document.createElement('td');
                let input;
                if (param.inputType === 'bool') {
                    tdInput.innerHTML = '<span class="type-info">will be "<b>y</b>" when enabled</span>';
                } else if (param.inputType === 'select') {
                    input = document.createElement('select');
                    input.id = 'input_' + param.name;
                    const blank = document.createElement('option');
                    blank.value = '';
                    blank.textContent = '--';
                    input.appendChild(blank);
                    (param.options || []).forEach(opt => {
                        const option = document.createElement('option');
                        option.value = opt.value;
                        option.textContent = opt.text;
                        input.appendChild(option);
                    });
                    tdInput.appendChild(input);
                } else if (param.inputType === 'number') {
                    input = document.createElement('input');
                    input.type = 'number';
                    input.id = 'input_' + param.name;
                    if (String(param.type).toLowerCase().startsWith('uint')) {
                        input.min = '0';
                    }
                    if (param.min !== undefined) input.min = param.min;
                    if (param.max !== undefined) input.max = param.max;
                    tdInput.appendChild(input);
                } else if (param.inputType === 'bitmask') {
                    renderBitmaskField(param, tdInput);
                } else if (param.inputType === 'datetime') {
                    renderDatetimeField(param, tdInput);
                } else {
                    input = document.createElement('input');
                    input.type = 'text';
                    input.id = 'input_' + param.name;
                    if (['UDefPSetsFileName','ParamMapFileName','CategoryMappingFile'].includes(param.name)) {
                        input.addEventListener('input', () => {
                            input.value = normalizeSlashes(input.value);
                        });
                    }
                    tdInput.appendChild(input);
                }
                const disabledNote = document.createElement('span');
                disabledNote.className = 'disabled-note';
                tdInput.appendChild(disabledNote);
                tr.appendChild(tdInput);
                tbody.appendChild(tr);
                renderedCount++;
            });
        });
        TOTAL_PARAMS = renderedCount;
        document.getElementById('hdrTotal').textContent = TOTAL_PARAMS;
        updateStats();
    }

    function loadAmericanDefaults() {
        parameters.forEach(param => {
            const checkbox = document.getElementById('check_' + param.name);
            if (checkbox) checkbox.checked = true;
            setParamValue(param.name, param.defaultExample);
        });
        applyDependencies();
        updateStats();
    }

    function setParamValue(paramName, value) {
        const param = paramByName[paramName];
        if (!param) return;
        const checkbox = document.getElementById('check_' + paramName);
        if (checkbox) checkbox.checked = true;
        if (param.inputType === 'bool') return;
        if (param.inputType === 'bitmask') {
            const td = getParamCell(paramName);
            const txt = document.getElementById('input_' + paramName);
            if (!td || !txt) return;
            const mask = parseMaskFromInput(String(value || '').trim(), param.bits || []);
            txt.value = String(mask);
            syncCheckboxesWithText(paramName, param.bits || []);
            return;
        }
        if (param.inputType === 'datetime') {
            const number = document.getElementById('input_' + paramName + '_num');
            const dt = document.getElementById('input_' + paramName + '_dt');
            if (!number || !dt) return;
            const v = String(value || '').trim();
            if (v === '' || v === '0') {
                number.value = '';
                dt.value = '';
                return;
            }
            if (/^\d+$/.test(v)) {
                number.value = v;
                const n = parseInt(v, 10);
                if (!isNaN(n) && n > 0) {
                    const d = new Date(n * 1000);
                    dt.value = dateToLocalString(d);
                } else {
                    dt.value = '';
                }
            } else {
                dt.value = v;
                const d = new Date(v);
                const sec = Math.floor(d.getTime() / 1000);
                number.value = (isNaN(sec) ? '' : String(sec));
            }
            return;
        }
        const input = document.getElementById('input_' + paramName);
        if (!input) return;
        if (param.inputType === 'select') {
            const sval = String(value || '').toLowerCase();
            const opts = Array.from(input.options);
            const match = opts.find(opt => opt.value.toLowerCase() === sval || opt.text.toLowerCase() === sval);
            if (match) input.value = match.value;
            else input.value = '';
        } else {
            if (['UDefPSetsFileName','ParamMapFileName','CategoryMappingFile'].includes(paramName)) {
                value = normalizeSlashes(value);
            }
            input.value = value == null ? '' : String(value);
        }
    }

    function dateToLocalString(d) {
        const pad = x => (x < 10 ? '0' : '') + x;
        const yyyy = d.getFullYear();
        const MM = pad(d.getMonth() + 1);
        const dd = pad(d.getDate());
        const hh = pad(d.getHours());
        const mm = pad(d.getMinutes());
        return `${yyyy}-${MM}-${dd}T${hh}:${mm}`;
    }

    function getParamCell(paramName) {
        const el = document.getElementById('input_' + paramName) || document.getElementById('input_' + paramName + '_num') || document.getElementById('input_' + paramName + '_dt');
        return el ? el.parentElement : null;
    }

    function loadPreset(preset) {
        clearAll();
        const presets = {
            standard: {
                params: {
                    'FileVersion': 'ifc4rv',
                    'FileType': 'ifc',
                    'LevelOfDetail': 'medium',
                    'IfcCommonPropSets': 'y',
                    'BaseQuantities': 'n',
                    'BimRvPropSets': 'n',
                    'MaterialPropSets': 'n',
                    'Schedules': 'n',
                    'SchedFilter': 'n',
                    'PaCity': 'use_default',
                    'PaCountry': 'use_default',
                    'FhFileDesc': 'Standard IFC export',
                    'FhAuthName': 'use_default',
                    'FhOrganiz': 'use_default',
                    'FhExchange': 'none',
                    'VisibleOnly': 'y',
                    'FilterViewId': 'auto',
                    'RoomsIn3D': 'n',
                    '2DPlanViewEl': 'n',
                    '2DRoomBound': 'n',
                    'ExportBoundBox': 'n',
                    'KeepTesGeomAsTriangl': 'n',
                    'DisableAnalyzers': 'n',
                    'ProjOrigin': 'currentshared'
                }
            },
            extended: {
                params: {
                    'FileVersion': 'ifc4dtv',
                    'FileType': 'ifc',
                    'LevelOfDetail': 'high',
                    'IfcCommonPropSets': 'y',
                    'BaseQuantities': 'y',
                    'BimRvPropSets': 'y',
                    'MaterialPropSets': 'y',
                    'Schedules': 'y',
                    'SchedFilter': 'y',
                    'PaProjDesc': 'use_default',
                    'PaCity': 'use_default',
                    'PaPostCode': 'use_default',
                    'PaCountry': 'use_default',
                    'PaAddrToBuild': 'y',
                    'PaAddrToSite': 'y',
                    'FhFileDesc': 'Extended IFC export with quantities and classifications',
                    'FhAuthName': 'use_default',
                    'FhAuthEmail': 'use_default',
                    'FhOrganiz': 'use_default',
                    'FhAuthoriz': 'use_default',
                    'FhAppName': 'use_default',
                    'FhVersion': 'use_default',
                    'FhFSchema': 'IFC4',
                    'FhExchange': 'architectural',
                    'VisibleOnly': 'n',
                    'RoomsIn3D': 'y',
                    '2DPlanViewEl': 'y',
                    '2DRoomBound': 'y',
                    'ExportBoundBox': 'y',
                    'KeepTesGeomAsTriangl': 'y',
                    'DisableAnalyzers': 'n',
                    'CategoryMappingFile': 'use_default',
                    'ClName': 'use_default',
                    'ClEdition': 'use_default',
                    'ClEditTime': 'use_default',
                    'ClDocLocation': 'use_default',
                    'ClFieldName': 'ClassificationCode',
                    'ProjOrigin': 'sitesurveypoint',
                    'GeoRefCRSName': 'use_default',
                    'GeoRefEPSGCode': 'use_default',
                    'GeoRefMapUnit': 'meter'
                }
            }
        };
        const selectedPreset = presets[preset];
        if (selectedPreset) {
            Object.keys(selectedPreset.params).forEach(paramName => {
                const param = parameters.find(p => p.name === paramName);
                const checkbox = document.getElementById('check_' + paramName);
                if (checkbox) checkbox.checked = true;
                let value = selectedPreset.params[paramName];
                if (value === 'use_default') {
                    value = param ? param.defaultExample : '';
                }
                setParamValue(paramName, value);
            });
        }
        applyDependencies();
        updateStats();
    }

    function clearAll() {
        parameters.forEach(param => {
            const checkbox = document.getElementById('check_' + param.name);
            if (checkbox) checkbox.checked = false;
            if (param.inputType === 'bitmask') {
                const txt = document.getElementById('input_' + param.name);
                if (txt) txt.value = '';
                const td = getParamCell(param.name);
                if (td) {
                    const cbs = td.querySelectorAll('.bitmask-container input[type="checkbox"]');
                    cbs.forEach(cb => cb.checked = false);
                }
            } else if (param.inputType === 'datetime') {
                const number = document.getElementById('input_' + param.name + '_num');
                const dt = document.getElementById('input_' + param.name + '_dt');
                if (number) number.value = '';
                if (dt) dt.value = '';
            } else {
                const input = document.getElementById('input_' + param.name);
                if (input) input.value = '';
            }
        });
        document.getElementById('output').classList.remove('show');
        applyDependencies();
        updateStats();
    }

    function selectAll() {
        parameters.forEach(param => {
            const checkbox = document.getElementById('check_' + param.name);
            if (checkbox) checkbox.checked = true;
        });
        applyDependencies();
        updateStats();
    }

    function updateStats() {
        const checked = document.querySelectorAll('#paramTable input[type="checkbox"][id^="check_"]:checked').length;
        document.getElementById('hdrTotal').textContent = TOTAL_PARAMS;
        document.getElementById('hdrSelected').textContent = checked;
    }

    function getCurrentParamValue(param) {
        if (param.inputType === 'bool') return 'y';
        if (param.inputType === 'bitmask') {
            const txt = document.getElementById('input_' + param.name);
            return txt ? txt.value : '';
        }
        if (param.inputType === 'datetime') {
            const number = document.getElementById('input_' + param.name + '_num');
            const dt = document.getElementById('input_' + param.name + '_dt');
            if (number && number.value) return number.value;
            if (dt && dt.value) {
                const d = new Date(dt.value);
                const sec = Math.floor(d.getTime() / 1000);
                return isNaN(sec) ? '' : String(sec);
            }
            return '';
        }
        const input = document.getElementById('input_' + param.name);
        let v = input ? input.value : '';
        if (PATH_PARAMS.has(param.name)) v = normalizePath(v);
        return v;
    }

    function generateCommand() {
        let converterPath = document.getElementById('converterPath').value;
        let filePath = document.getElementById('filePath').value;
        converterPath = stripOuterQuotes(converterPath);
        filePath = stripOuterQuotes(filePath);
        // converterPath = normalizeSlashes(converterPath);
        // filePath     = normalizeSlashes(filePath);
        if (!converterPath) {
            converterPath = 'C:/DDC_Converter/RVT2IFCconverter.exe';
            document.getElementById('converterPath').value = converterPath;
        }
        if (!filePath) {
            filePath = 'C:/Projects/sample_project.rvt';
            document.getElementById('filePath').value = filePath;
        }
        // Build selected params with priority: FilterViewId over FilterViewName
        const selectedParams = [];
        let hasFilterViewId = false;
        let hasFilterViewName = false;
        let filterViewIdValue = '';
        let filterViewNameValue = '';
        parameters.forEach(param => {
            const checkbox = document.getElementById('check_' + param.name);
            if (!checkbox || !checkbox.checked) return;
            const value = getCurrentParamValue(param);
            if (value === '') return;
            if (param.name === 'FilterViewId') {
                hasFilterViewId = true;
                filterViewIdValue = value;
            } else if (param.name === 'FilterViewName') {
                hasFilterViewName = true;
                filterViewNameValue = value;
            } else {
                selectedParams.push(`${param.name}=${asQuoted(value)}`);
            }
        });
        // Mutual exclusion enforcement in generation (fail-safe)
        if (hasFilterViewId) {
            selectedParams.push(`FilterViewId=${asQuoted(filterViewIdValue)}`);
        } else if (hasFilterViewName) {
            selectedParams.push(`FilterViewName=${asQuoted(filterViewNameValue)}`);
        }
        if (selectedParams.length === 0) {
            alert('Please select at least one parameter to generate the command.');
            return;
        }
        const outputPath = filePath.replace(/\.rvt$/i, '.ifc');
        const command1 = `${asQuoted(converterPath)} ${asQuoted(filePath)} ${asQuoted(outputPath)} mode=custom ${selectedParams.join(' ')}`;
        const configParams = [...selectedParams];
        const command2 = configParams.join('; ');
        const outputDiv = document.getElementById('output');
        const outputContent = document.getElementById('outputContent');
        outputContent.innerHTML =
            `<span class="output-header">Option 1 (For Command-Line Execution):</span>${command1}\n\n` +
            `<span class="output-header">Option 2 (For the "Custom" field in the UI version):</span>${command2}`;
        outputDiv.classList.add('show');
    }

    function copyToClipboard() {
        const outputContent = document.getElementById('outputContent').textContent;
        navigator.clipboard.writeText(outputContent).then(() => {
            const button = document.querySelector('.copy-button');
            const originalText = button.textContent;
            button.textContent = 'Copied!';
            setTimeout(() => {
                button.textContent = originalText;
            }, 2000);
        });
    }
    // --- Theme switch ---
    function applyTheme(theme) {
        const dark = theme === 'dark';
        document.body.classList.toggle('dark', dark);
        const btn = document.getElementById('themeToggle');
        if (btn) btn.textContent = dark ? 'ðŸŒ™ Dark' : 'ðŸŒž Light';
    }

    function toggleTheme() {
        const isDark = !document.body.classList.contains('dark');
        applyTheme(isDark ? 'dark' : 'light');
    }

    function initTheme() {
        const mq = window.matchMedia('(prefers-color-scheme: dark)');
        applyTheme(mq.matches ? 'dark' : 'light');
        mq.addEventListener('change', e => applyTheme(e.matches ? 'dark' : 'light'));
    }
    // Initialize table and dependencies
    (function() {
        createTable();
        initTheme();
        initDependencies();
    })();
</script>
</body>
</html>